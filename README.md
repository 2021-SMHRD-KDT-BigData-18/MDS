# MDS

## 팀명 : MDS(문단속)
## 👀서비스 소개
 <li>서비스명 : YOLO기반 소 축사 침입 감지 안전관리 CCTV 시스템</li>
 <li>서비스 설명 : YOLO기반 CCTV를 이용하여 소축사 입구의 출입 Counting 및 자동차 번호판을 인식한다.</li>
또한 침입하는 사람, 차량등을 인식하여 실시간 알림을 보내준다.</li>

## 📅 프로젝트 기간
2023.07.12 ~ 2023.08.08 (4주)

## ⭐ 주요 기능
- 사람과 차량의 출입 수를 카운트
- 차량 번호판 인식
- 사람과 차량의 출입 감지
- 침입 관련 실시간 알림 전송

##  기술스택
|구분|내용|
|------|---|
|Front-end|<img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white"> <img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white"> <img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black"> <img src="https://img.shields.io/badge/bootstrap-7952B3?style=for-the-badge&logo=bootstrap&logoColor=white"> |
|Back-end|<img src="https://user-images.githubusercontent.com/130940590/241096022-42acfffa-c7f3-49b6-823e-12d56a93f0bd.png"> <img src="https://img.shields.io/badge/node.js-339933?style=for-the-badge&logo=Node.js&logoColor=white"> <img src="https://img.shields.io/badge/spring-6DB33F?style=for-the-badge&logo=spring&logoColor=white"> <img src="https://img.shields.io/badge/flask-000000?style=for-the-badge&logo=flask&logoColor=white">|
|Modeling|<img src="https://img.shields.io/badge/python-3776AB?style=for-the-badge&logo=python&logoColor=white"> <img src="https://img.shields.io/badge/visual studio-3776AB?style=for-the-badge&logo=visualstudio&logoColor=white"> <img src="https://img.shields.io/badge/jupyter notebook-E34F26?style=for-the-badge&logo=jupyter&logoColor=white">
|DB|<img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white"> |
|협업|<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white"> |

## ⚙ 시스템 아키텍처(구조)

<img src="https://user-images.githubusercontent.com/130714531/241093670-22572e27-0de3-4d83-a78f-7b6a54eeff38.png">

<br>

## 📌 SW유스케이스

<br>

<img src="https://user-images.githubusercontent.com/130940590/241100079-6b94474f-91c2-4ead-95ee-cc82643f37e8.png">



<br>

## 📌 서비스 흐름도

<br>


<img src="https://user-images.githubusercontent.com/130940590/241100791-fb6b04a7-0e7e-453a-8776-2e98c24cbb14.png" width="1012px">




<br>

## 📌 ER다이어그램

<br>


<img src="https://user-images.githubusercontent.com/130940590/241101185-385eb45e-addb-4e68-ac50-83def93ea0af.png"  width="1012px">


## 🖥 화면 구성

<메인페이지>

<br>

<img src="https://user-images.githubusercontent.com/130940590/241101851-c66bcfdd-c92e-4acc-bbbe-5cfdccc0fb68.png" width="1012">

<br>

<카테고리 페이지>
<br>

<img src="https://user-images.githubusercontent.com/130940590/241102744-25442b91-6187-4397-86b1-62fe6d6b9c44.png" width="1012">

<br>

<웹화면 키워드 검색>

<br>

<img src="https://user-images.githubusercontent.com/130940590/241103083-a81070b6-ad74-4242-b585-387e4670a524.png" width="1012">

<br>

<웹화면 상품정보>

<br>

<img src="https://user-images.githubusercontent.com/130940590/241103373-fb6a7562-3155-4fd9-870e-db005a13fd94.png"  width="1012">

<br>

<판매글작성>

<br>

<img src="https://user-images.githubusercontent.com/130940590/241104480-8c39cc4f-ecee-4286-ab0c-3410eab2eec9.png" width = "1012">

<br>

<스파이더맨 매칭>

<br>

<img src="https://user-images.githubusercontent.com/130940590/241104657-123f87af-71a2-45f0-a53f-984417398be9.png"  width="1012">

<br>


<스파이더맨 신청>

<br>

![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/f7414af0-3a6f-4628-a03c-186ef683723e)

<br>


<내정보>

<br>

![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/4df338d1-4733-4074-b3a1-2d9f23ffe5b3)

<br>

<입/출금>

<br>

![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/1bb9ce73-a3dd-4fee-8bb1-ce78cdf258d0)

<br>

<구매신청>

<br>

![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/936771c6-dfc6-4dee-ba62-97e748af08b9)

<br>


<지도>

<br>


![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/063b83c4-e28f-4269-ad17-a5847a8b977f)


<br>

<채팅>

<br>

![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/fddf9c57-09d6-4c0e-a5a1-ad1a971dd042)

<br>




## 🤾‍♂️ 트러블슈팅
### [지도 api]
카카오맵 api 중 'geolocation으로 마커 표시하기'와 '좌표로 주소를 얻어내기'를 사용하여
현재 위치를 기반으로 지도가 보여지고 원하는 위치에 좌표를 찍어 주소를 db에 저장하는 기능을 구현.

#### 문제 1. JS에서 변수로 선언된 데이터들을 db에 저장하는 부분에서 어려움을 겪었다.

#### 해결방안 1. 
input에 type="text"로 코드를 작성하여 view 화면에 불필요한 데이터들이 출력되는 상황이 생겼다.
이를 해결하기 위해서 input에 type="hidden"으로 변경 후 JS에서 각각의 input id에 값을 지정하여 문제 해결
||
|------|
|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/1a0bee02-afaf-4757-9b14-36ee5396bba0)|


#### 해결방안 2. 
위도와 경도를 확인하기 위해서 '좌표로 주소를 얻어내기'의 .latlng를 각각 .getlat와 .getlng로 분리하여 db에 저장
||
|------|
|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/89d3c96c-7b92-4982-bdfd-db75f820b501)|



#### 문제 2. 거래지역을 설정 후 db에 저장된 지번 주소명을 사용자가 보는 view 화면에 출력하는 부분에서 어려움을 겪었다.

#### 해결방안 1. 
a태그 안에 href="javascript:openwindow();"로 함수를 선언한 후 JS에서 window.open으로 자식창을 생성.
자식창에서 지도 url을 띄우고 좌표가 찍힌 위치의 주소명을 부모창에서 확인할 수 있도록 '$(opener.document).find()'를 사용해 부모창 p태그에 출력 
|||
|------|-----|
|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/e092b62a-5e4c-4519-bf0c-bc794066a5f5) |![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/f331ffed-278c-4c6f-9bf9-d32caf625e14)


--------------------------------------------------------------------------------------------------------------------------------------------------

### [웹소켓 실시간 채팅]
#### 문제. 현재 교육 커리큘럼에서 스프링을 배우지 못한 상태였기에 MVC로 웹소켓을 구현하는 것이 목표였다.

#### 해결방안. 
JS에서 유저의 아이디, 이름, 채팅내용 등을 변수로 받아와 POJO에 @ServerEndpoint 어노테이션을 설정하여 해당 데이터들을 수집하고 기능이 구현되게끔 DAO를 작성.

#### 참고문헌.
https://dev-woo.tistory.com/44

|.jsp|
|------|
|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/3951a486-75d9-459c-88da-51c17d705578) ![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/d27edb19-5339-4016-b534-a561b4423789) ![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/3455e3e3-35e0-4828-9e29-5de33d3f25cc) ![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/7eef9645-9012-4253-b88b-107e7c574c57)
|.java|
|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/aa63114b-2162-4d33-97dd-2e60e66078b1) ![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/b19cec21-2ffe-4e4d-a75b-37a3da89b135)


--------------------------------------------------------------------------------------------------------------------------------------------------
 
### [mybatis에서 selectkey를 이용하여 insert문 작성]
 
#### 문제. 지도 테이블에서 'loc_seq' 컬럼을 primary key로 설정 후 시퀀스를 생성하고 상품 테이블에서 'loc_seq'컬럼을 외래키로 연결한 상태였다. 상품 테이블과 연결된 mybatis에서 insert쿼리문을 작성하여 db에 데이터를 저장하려고 하였지만 외래키로 연결된 'loc_seq'컬럼에서 값을 저장할 수 없다는 오류가 발생했다.
 
#### 해결방안. 
지도 테이블에 있는 insert 쿼리문을 기반으로 상품 테이블에 selectkey를 입력해주어 'loc_seq'컬럼을 연결.
|지도위치 테이블|상품 테이블|
|------|---|
|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/9699fdfe-0001-4cc1-9c4d-d308a5629acb)|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/6fa0ca28-851f-42ed-b571-e0b713c836be)





##  🔨보완사항
### [스파이더맨 매칭]
|스파이더맨이 요청을 수락하는 화면|매칭된 스파이더맨의 정보와 위치 출력|
|------|---|
|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/707087d9-0f79-474a-bdb0-63c599ff80a9)|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/0752425e-d4d4-46f7-a432-225207ba29e8)|

구현에 완벽하게 성공하지는 못했지만 카카오 택시의 매칭 알고리즘과 배달의민족 라이더 매칭 알고리즘 등을 찾아보고 이를 토대로 검수자 매칭 알고리즘을 설계하려고 노력하였다.


### [결제 api]
|포인트와 머니 조회 화면|결제 화면|
|------|---|
|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/523b5c08-8f97-49f8-bc5b-67ee1f72a001)|![image](https://github.com/2021-SMHRD-KDT-BigData-18/Aranea/assets/130940590/742f6d2c-0a2b-421c-a78f-5633484b3284)|

가상계좌로 아라냐머니를 통해 결제가 진행이 되게끔 구현하고 싶었지만 아임포트 api나 금융결제원 오픈api로 구현하기가 힘들어 보류된 부분이다.



## 👨‍👩‍👦‍👦 팀원 역할
|박현주|이경민|박상준|강태호|이예은|
|------|---|---|---|---|
|프로젝트 총괄|기능구현|프론트 총괄|JSP CSS 디자인|화면관리|
|BACKEND 코드구현|DB 설계/관리|JSP CSS 디자인|화면설계|PPT 자료준비|
|DB 데이터 관리|BACKEND 코드구현|화면설계|영상제작 및 발표|로고 및 아이콘 제작|
|[github](guswn100059@gmail.com)|[github](rudalswjdghk@gmail.com)|[github](epqlftkdcn@naver.com)|[github](rose4123@naver.com)|[github](yeeun1314@naver.com)|

